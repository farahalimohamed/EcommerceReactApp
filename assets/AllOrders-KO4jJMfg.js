import{j as e,b as l,O as P,t as I}from"./index-DxzwiYFp.js";import{L as S}from"./Loader-DHVGsxAk.js";import{H as E}from"./Helmet-DlFjghzm.js";class o extends Error{}o.prototype.name="InvalidTokenError";function L(a){return decodeURIComponent(atob(a).replace(/(.)/g,(r,s)=>{let d=s.charCodeAt(0).toString(16).toUpperCase();return d.length<2&&(d="0"+d),"%"+d}))}function M(a){let r=a.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return L(r)}catch{return atob(r)}}function D(a,r){if(typeof a!="string")throw new o("Invalid token specified: must be a string");r||(r={});const s=r.header===!0?0:1,d=a.split(".")[s];if(typeof d!="string")throw new o(`Invalid token specified: missing part #${s+1}`);let c;try{c=M(d)}catch(n){throw new o(`Invalid token specified: invalid base64 for part #${s+1} (${n.message})`)}try{return JSON.parse(c)}catch(n){throw new o(`Invalid token specified: invalid json for part #${s+1} (${n.message})`)}}function U({selectedItem:a,hideModal:r}){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"bg-[rgba(0,0,0,0.5)] fixed inset-0 flex justify-center items-center",children:e.jsx("div",{className:"relative p-4 w-full max-w-2xl max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow-sm dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600 border-gray-200",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Order Details"}),e.jsxs("button",{onClick:r,type:"button",className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"default-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsx("div",{className:"p-4 md:p-5 space-y-4",children:e.jsx("div",{class:"relative overflow-x-auto",children:e.jsxs("table",{class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400",children:[e.jsx("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",class:"px-6 py-3",children:"Image"}),e.jsx("th",{scope:"col",class:"px-6 py-3",children:"Product name"}),e.jsx("th",{scope:"col",class:"px-6 py-3",children:"Qty"}),e.jsx("th",{scope:"col",class:"px-6 py-3",children:"Price"})]})}),e.jsx("tbody",{children:a.map(s=>e.jsxs("tr",{class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 border-gray-200",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("img",{src:s.product.imageCover,alt:s.product.title,class:"w-20 h-20 object-cover rounded-lg"})}),e.jsx("td",{class:"px-6 py-4",children:s.product.title}),e.jsx("td",{class:"px-6 py-4",children:s.count}),e.jsxs("td",{class:"px-6 py-4",children:[s.price," EGP"]})]},s._id))})]})})}),e.jsx("div",{className:"flex items-center p-4 md:p-5 border-t border-gray-200 rounded-b dark:border-gray-600",children:e.jsx("button",{onClick:r,type:"button",className:"text-white bg-[#6456FF] hover:bg-[#5647ff] font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700",children:"Close"})})]})})})})}function T(){const{getUserOrders:a}=l.useContext(P),{token:r}=l.useContext(I),[s,d]=l.useState([]),[c,n]=l.useState([]),[h,x]=l.useState(1),[g]=l.useState(10),[p,m]=l.useState(!1),[f,y]=l.useState(!0);function j(t){n(t),m(!0)}function w(){m(!1)}function k(){let t=D(r);v(t.id)}async function v(t){try{let i=await a(t);d(i.data)}catch(i){console.error("Error fetching orders:",i)}finally{y(!1)}}l.useEffect(()=>{r&&(y(!0),k())},[r]);const u=h*g,N=u-g,C=s.slice(N,u),O=t=>x(t),b=Math.ceil(s.length/g);return e.jsxs(e.Fragment,{children:[f?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(S,{})}):e.jsxs("section",{className:"bg-white py-8 antialiased dark:bg-gray-900 md:py-16",children:[e.jsx(E,{children:e.jsx("title",{children:"My Orders"})}),e.jsx("div",{className:"mx-auto max-w-screen-xl px-4 2xl:px-0",children:e.jsxs("div",{className:"mx-auto max-w-5xl",children:[e.jsx("div",{className:"gap-4 sm:flex sm:items-center sm:justify-between",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white sm:text-2xl",children:"My orders"})}),e.jsx("div",{className:"mt-6 flow-root sm:mt-8",children:e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:C.map(t=>e.jsxs("div",{className:"flex flex-wrap items-center gap-y-4 py-6",children:[e.jsxs("dl",{className:"w-1/2 sm:w-1/4 lg:w-auto lg:flex-1",children:[e.jsx("dt",{className:"text-base font-medium text-gray-500 dark:text-gray-400",children:"Order ID:"}),e.jsx("dd",{className:"mt-1.5 text-base font-semibold text-gray-900 dark:text-white",children:e.jsx("a",{href:"#",className:"hover:underline",children:t.id})})]}),e.jsxs("dl",{className:"w-1/2 sm:w-1/4 lg:w-auto lg:flex-1",children:[e.jsx("dt",{className:"text-base font-medium text-gray-500 dark:text-gray-400",children:"Date:"}),e.jsx("dd",{className:"mt-1.5 text-base font-semibold text-gray-900 dark:text-white",children:new Date(t.createdAt).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("dl",{className:"w-1/2 sm:w-1/4 lg:w-auto lg:flex-1",children:[e.jsx("dt",{className:"text-base font-medium text-gray-500 dark:text-gray-400",children:"Total Price:"}),e.jsxs("dd",{className:"mt-1.5 text-base font-semibold text-gray-900 dark:text-white",children:[t.totalOrderPrice," EGP"]})]}),e.jsxs("dl",{className:"w-1/2 sm:w-1/4 lg:w-auto lg:flex-1",children:[e.jsx("dt",{className:"text-base font-medium text-gray-500 dark:text-gray-400",children:"Payment Method:"}),e.jsx("dd",{className:"mt-1.5 text-base font-semibold text-gray-900 dark:text-white",children:t.paymentMethodType})]}),e.jsxs("dl",{className:"w-1/2 sm:w-1/4 lg:w-auto lg:flex-1",children:[e.jsx("dt",{className:"text-base font-medium text-gray-500 dark:text-gray-400",children:"Status:"}),e.jsx("dd",{className:"mt-1.5 text-base font-semibold text-gray-900 dark:text-white",children:t.isPaid?"Paid":"Not paid"})]}),e.jsx("div",{className:"w-full grid sm:grid-cols-2 lg:flex lg:w-64 lg:items-center lg:justify-end gap-4",children:e.jsx("button",{className:"w-full inline-flex justify-center rounded-lg  border border-gray-200 bg-white px-3 py-2 text-sm font-medium text-gray-900 hover:bg-gray-100 hover:text-primary-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white lg:w-auto",type:"button",onClick:()=>j(t.cartItems),children:"View details"})})]},t.id))})}),e.jsx("nav",{className:"mt-6 flex items-center justify-center sm:mt-8","aria-label":"Page navigation example",children:e.jsxs("ul",{className:"flex h-8 items-center -space-x-px text-sm",children:[e.jsx("li",{children:e.jsxs("button",{onClick:()=>x(t=>t>1?t-1:t),className:"ms-0 flex h-8 items-center justify-center rounded-s-lg border border-e-0 border-gray-300 bg-white px-3 leading-tight text-gray-500 hover:bg-gray-100 hover:text-gray-700 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Previous"}),e.jsx("svg",{className:"h-4 w-4 rtl:rotate-180","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m15 19-7-7 7-7"})})]})}),Array.from({length:b},(t,i)=>i+1).map(t=>e.jsx("li",{children:e.jsx("button",{onClick:()=>O(t),className:`flex h-8 items-center justify-center border border-gray-300 bg-white px-3 leading-tight text-gray-500 hover:bg-gray-100 hover:text-gray-700 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white ${h===t?"z-10 bg-primary-50 text-primary-600 dark:bg-gray-700 dark:text-white":""}`,children:t})},t)),e.jsx("li",{children:e.jsxs("button",{onClick:()=>x(t=>t<b?t+1:t),className:"flex h-8 items-center justify-center rounded-e-lg border border-gray-300 bg-white px-3 leading-tight text-gray-500 hover:bg-gray-100 hover:text-gray-700 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Next"}),e.jsx("svg",{className:"h-4 w-4 rtl:rotate-180","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m9 5 7 7-7 7"})})]})})]})})]})})]}),p&&e.jsx(U,{hideModal:w,selectedItem:c})]})}export{T as default};
