import{b as s,C as j,u as k,i as N,j as e}from"./index-C6SzbBKQ.js";import{c as w,a as t,u as v,A as C}from"./index-BN9X0MpP.js";import{H as S}from"./Helmet-BVGOygXr.js";function E(){const{cashOnDelivery:x,setNumOfCartItems:l,setCartId:i,onlinePayment:u,totalCartPrice:d}=s.useContext(j),[n,o]=s.useState(null),[h,c]=s.useState(!1),p=k(),{state:g}=N(),y={details:"",phone:"",city:""},f=w({details:t().required("Details is required"),phone:t().required("Phone is required").matches(/^01[0125][0-9]{8}$/,"Invalid phone number"),city:t().required("City is required")});async function b(m){c(!0),o(null);try{if(g==="online"){let a=await u({shippingAddress:m});a.status==="success"&&(l(0),i(null),window.location.href=a.session.url)}else(await x({shippingAddress:m})).status==="success"&&(l(0),i(null),p("/allorders"))}catch{o("An error occurred during the payment process. Please try again.")}finally{c(!1)}}const r=v({initialValues:y,validationSchema:f,onSubmit:b});return e.jsxs("section",{className:"bg-white py-8 antialiased dark:bg-gray-900 md:py-16",children:[e.jsx(S,{children:e.jsx("title",{children:"Checkout"})}),e.jsx("form",{onSubmit:r.handleSubmit,className:"mx-auto max-w-screen-xl px-4 2xl:px-0",children:e.jsxs("div",{className:"mt-6 sm:mt-8 lg:flex lg:items-start lg:gap-12 xl:gap-16",children:[e.jsx("div",{className:"min-w-0 flex-1 space-y-8",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Delivery Details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"details",className:"mb-2 block text-sm font-medium text-gray-900 dark:text-white",children:"Details"}),e.jsx("input",{type:"text",id:"details",className:"block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-primary-500 focus:ring-primary-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-400 dark:focus:border-primary-500 dark:focus:ring-primary-500",placeholder:"Bonnie Green",name:"details",value:r.values.details,onChange:r.handleChange,onBlur:r.handleBlur}),r.errors.details&&r.touched.details&&e.jsx("small",{className:"text-red-600",children:r.errors.details})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"mb-2 block text-sm font-medium text-gray-900 dark:text-white",children:"Your phone"}),e.jsx("input",{type:"tel",id:"phone",className:"block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-primary-500 focus:ring-primary-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-400 dark:focus:border-primary-500 dark:focus:ring-primary-500",placeholder:"+1 (555) 1234-567",name:"phone",value:r.values.phone,onChange:r.handleChange,onBlur:r.handleBlur}),r.errors.phone&&r.touched.phone&&e.jsx("small",{className:"text-red-600",children:r.errors.phone})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"mb-2 block text-sm font-medium text-gray-900 dark:text-white",children:"Your city"}),e.jsx("input",{type:"text",id:"city",className:"block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-primary-500 focus:ring-primary-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-400 dark:focus:border-primary-500 dark:focus:ring-primary-500",placeholder:"eg. New York",name:"city",value:r.values.city,onChange:r.handleChange,onBlur:r.handleBlur}),r.errors.city&&r.touched.city&&e.jsx("small",{className:"text-red-600",children:r.errors.city})]})]})]})}),e.jsx("div",{className:"mt-6 w-full space-y-6 sm:mt-8 lg:mt-0 lg:max-w-xs xl:max-w-md",children:e.jsxs("div",{className:"bg-gray-100 rounded-md p-4 h-max",children:[e.jsxs("ul",{className:"text-gray-800 space-y-3",children:[e.jsxs("li",{className:"flex flex-wrap gap-4 text-sm",children:["Subtotal"," ",e.jsxs("span",{className:"ml-auto font-bold",children:[d," EGP"]})]}),e.jsxs("li",{className:"flex flex-wrap gap-4 text-sm",children:["Shipping ",e.jsx("span",{className:"ml-auto font-bold",children:"0.00"})]}),e.jsxs("li",{className:"flex flex-wrap gap-4 text-sm",children:["Tax ",e.jsx("span",{className:"ml-auto font-bold",children:"0.00"})]}),e.jsx("hr",{className:"border-gray-300"}),e.jsxs("li",{className:"flex flex-wrap gap-4 text-sm font-bold",children:["Total ",e.jsxs("span",{className:"ml-auto",children:[d," EGP"]})]})]}),e.jsxs("div",{className:"space-y-3 mt-5",children:[n&&e.jsx("div",{className:"bg-red-300 p-3 rounded-md",children:n}),h?e.jsx("button",{type:"submit",disabled:!0,className:"flex w-full items-center justify-center rounded-lg bg-[#6456ff] hover:bg-[#5647ff] px-5 py-2.5 text-sm font-medium text-white dark:bg-[#6456ff] dark:hover:bg-[#5647ff]",children:e.jsx(C,{className:"animate-spin"})}):e.jsx("button",{disabled:!r.isValid||!r.dirty,type:"submit",className:"btn",children:"Proceed to Payment"})]})]})})]})})]})}export{E as default};
